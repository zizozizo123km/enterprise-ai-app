// Reducer for complex auth state management